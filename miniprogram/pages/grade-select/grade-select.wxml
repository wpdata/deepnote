<view class="container">
  <!-- 头部说明 -->
  <view class="header">
    <text class="title">{{isFirstTime ? '欢迎使用智能错题本' : '修改年级'}}</text>
    <text class="subtitle">{{isFirstTime ? '请设置你的个人信息' : '选择你当前所在的年级'}}</text>
  </view>

  <!-- 昵称输入（仅首次显示） -->
  <view class="nickname-section" wx:if="{{isFirstTime}}">
    <view class="input-label">你的昵称</view>
    <input
      class="nickname-input"
      type="nickname"
      placeholder="请输入你的昵称"
      value="{{nickName}}"
      bindinput="onNicknameInput"
      maxlength="20"
    />
  </view>

  <!-- 年级选择区域 -->
  <view class="grade-sections">
    <!-- 小学 -->
    <view class="grade-section">
      <view class="section-title">小学</view>
      <view class="grade-grid">
        <view
          wx:for="{{primaryGrades}}"
          wx:key="level"
          class="grade-item {{selectedGrade && selectedGrade.level === item.level ? 'selected' : ''}}"
          data-level="{{item.level}}"
          data-category="{{item.category}}"
          data-display="{{item.display}}"
          bindtap="onSelectGrade"
        >
          <text class="grade-text">{{item.display}}</text>
        </view>
      </view>
    </view>

    <!-- 初中 -->
    <view class="grade-section">
      <view class="section-title">初中</view>
      <view class="grade-grid">
        <view
          wx:for="{{middleGrades}}"
          wx:key="level"
          class="grade-item {{selectedGrade && selectedGrade.level === item.level ? 'selected' : ''}}"
          data-level="{{item.level}}"
          data-category="{{item.category}}"
          data-display="{{item.display}}"
          bindtap="onSelectGrade"
        >
          <text class="grade-text">{{item.display}}</text>
        </view>
      </view>
    </view>

    <!-- 高中 -->
    <view class="grade-section">
      <view class="section-title">高中</view>
      <view class="grade-grid">
        <view
          wx:for="{{highGrades}}"
          wx:key="level"
          class="grade-item {{selectedGrade && selectedGrade.level === item.level ? 'selected' : ''}}"
          data-level="{{item.level}}"
          data-category="{{item.category}}"
          data-display="{{item.display}}"
          bindtap="onSelectGrade"
        >
          <text class="grade-text">{{item.display}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="footer">
    <button class="confirm-btn" bindtap="onConfirm">确认</button>
    <button wx:if="{{isFirstTime}}" class="skip-btn" bindtap="onSkip">暂时跳过</button>
  </view>
</view>
