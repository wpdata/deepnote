<view class="container">
  <!-- é¢˜ç›®ä¿¡æ¯å¡ç‰‡ -->
  <view class="question-card">
    <view class="question-header">
      <view class="subject-tag">{{question.subject}}</view>
      <view class="knowledge-tag">{{question.knowledgePoint}}</view>
      <view class="difficulty-tag difficulty-{{question.difficulty}}">
        {{question.difficulty === 'easy' ? 'ç®€å•' : question.difficulty === 'hard' ? 'å›°éš¾' : 'ä¸­ç­‰'}}
      </view>
      <view class="mastered-status {{question.mastered ? 'mastered' : ''}}">
        {{question.mastered ? 'å·²æŒæ¡' : 'å¾…æŒæ¡'}}
      </view>
    </view>

    <!-- é¢˜å‹å’Œç»ƒä¹ ç»Ÿè®¡ -->
    <view wx:if="{{question.questionType || question.practiceCount > 0}}" class="question-meta">
      <text wx:if="{{question.questionType}}" class="meta-item">ğŸ“ {{question.questionType}}</text>
      <text wx:if="{{question.practiceCount > 0}}" class="meta-item">
        ğŸ¯ ç»ƒä¹  {{question.practiceCount}} æ¬¡
        <text wx:if="{{question.correctCount > 0}}" class="success-text"> (ç­”å¯¹{{question.correctCount}}æ¬¡)</text>
      </text>
    </view>

    <view class="question-content">
      <text class="content-title">é¢˜ç›®å†…å®¹</text>
      <text class="content-text">{{question.content}}</text>
    </view>

    <image wx:if="{{question.imageUrl}}" class="question-image" src="{{question.imageUrl}}" mode="widthFix"></image>
  </view>

  <!-- ç­”æ¡ˆä¿¡æ¯å¡ç‰‡ -->
  <view wx:if="{{question.userAnswer || question.correctAnswer}}" class="answer-card">
    <view class="card-title">ğŸ“ ç­”æ¡ˆä¿¡æ¯</view>

    <view wx:if="{{question.userAnswer}}" class="answer-section">
      <text class="answer-label">æˆ‘çš„ç­”æ¡ˆ</text>
      <text class="answer-value">{{question.userAnswer}}</text>
    </view>

    <view wx:if="{{question.correctAnswer}}" class="answer-section">
      <text class="answer-label">æ­£ç¡®ç­”æ¡ˆ</text>
      <text class="answer-value correct">{{question.correctAnswer}}</text>
    </view>

    <view wx:if="{{question.isCorrect !== null}}" class="answer-section">
      <text class="answer-label">åˆ¤é¢˜ç»“æœ</text>
      <view class="result-tag {{question.isCorrect ? 'correct' : 'wrong'}}">
        {{question.isCorrect ? 'âœ“ æ­£ç¡®' : 'âœ— é”™è¯¯'}}
      </view>
    </view>
  </view>

  <!-- AI åˆ†æå¡ç‰‡ -->
  <view class="analysis-card">
    <view class="card-title">
      <image class="ai-icon" src="/images/ai.png" mode="aspectFit"></image>
      <text>AI æ™ºèƒ½åˆ†æ (DeepSeek)</text>
    </view>

    <view class="analysis-section">
      <text class="section-content">{{aiAnalysisText || 'æš‚æ— AIåˆ†æ'}}</text>
    </view>
  </view>

  <!-- ç›¸å…³çŸ¥è¯†ç‚¹ -->
  <view class="related-card">
    <text class="card-title">ç›¸å…³çŸ¥è¯†ç‚¹</text>
    <view class="tag-list">
      <view class="tag-item" wx:for="{{relatedKnowledge}}" wx:key="index">
        {{item}}
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="startPractice">
      <image class="btn-icon" src="/images/practice.png" mode="aspectFit"></image>
      å¼ºåŒ–ç»ƒä¹ 
    </button>
    <button class="action-btn primary {{question.mastered ? 'mastered' : ''}}" bindtap="toggleMastered">
      <image class="btn-icon" src="/images/{{question.mastered ? 'check' : 'uncheck'}}.png" mode="aspectFit"></image>
      {{question.mastered ? 'å·²æŒæ¡' : 'æ ‡è®°å·²æŒæ¡'}}
    </button>
  </view>
</view>
