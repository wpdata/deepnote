<view class="container">
  <!-- é¡¶éƒ¨è¯´æ˜ -->
  <view class="header">
    <view class="title">ğŸ“ ç®—æœ¯æ£€æŸ¥</view>
    <view class="subtitle">æ‹ç…§ä¸Šä¼ ç®—æœ¯ä½œä¸šï¼ŒAIè‡ªåŠ¨æ‰¹æ”¹</view>
  </view>

  <!-- æ‹ç…§/é€‰æ‹©å›¾ç‰‡åŒºåŸŸ -->
  <view wx:if="{{!imageUrl}}" class="upload-area">
    <view class="upload-box" bindtap="chooseImage">
      <text class="upload-emoji">ğŸ“·</text>
      <text class="upload-text">æ‹ç…§æˆ–é€‰æ‹©å›¾ç‰‡</text>
      <text class="upload-hint">æ”¯æŒåŠ å‡ä¹˜é™¤ç®—æœ¯é¢˜</text>
    </view>
  </view>

  <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
  <view wx:if="{{imageUrl && !checkResult}}" class="preview-area">
    <image class="preview-image" src="{{imageUrl}}" mode="widthFix"></image>
    <view class="action-buttons">
      <button class="action-btn secondary" bindtap="reChooseImage">é‡æ–°é€‰æ‹©</button>
      <button class="action-btn primary" bindtap="startCheck" disabled="{{checking}}">
        {{checking ? 'æ£€æŸ¥ä¸­...' : 'å¼€å§‹æ£€æŸ¥'}}
      </button>
    </view>
  </view>

  <!-- æ£€æŸ¥ç»“æœåŒºåŸŸ -->
  <view wx:if="{{checkResult}}" class="result-area">
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-card">
      <view class="stat-item">
        <text class="stat-value">{{checkResult.totalCount}}</text>
        <text class="stat-label">æ€»é¢˜æ•°</text>
      </view>
      <view class="stat-item correct">
        <text class="stat-value">{{checkResult.correctCount}}</text>
        <text class="stat-label">æ­£ç¡®</text>
      </view>
      <view class="stat-item wrong">
        <text class="stat-value">{{checkResult.wrongCount}}</text>
        <text class="stat-label">é”™è¯¯</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{checkResult.score}}åˆ†</text>
        <text class="stat-label">å¾—åˆ†</text>
      </view>
    </view>

    <!-- é”™é¢˜åˆ—è¡¨ -->
    <view wx:if="{{checkResult.wrongCount > 0}}" class="wrong-list">
      <view class="list-header">
        <text class="list-title">âŒ é”™é¢˜æ˜ç»†</text>
      </view>
      <view class="wrong-item" wx:for="{{checkResult.wrongItems}}" wx:key="index">
        <view class="item-number">ç¬¬{{item.index + 1}}é¢˜</view>
        <view class="item-content">
          <view class="expression">{{item.expression}}</view>
          <view class="answer-row">
            <text class="label">æˆ‘çš„ç­”æ¡ˆï¼š</text>
            <text class="user-answer wrong">{{item.userAnswer}}</text>
          </view>
          <view class="answer-row">
            <text class="label">æ­£ç¡®ç­”æ¡ˆï¼š</text>
            <text class="correct-answer">{{item.correctAnswer}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å…¨å¯¹æç¤º -->
    <view wx:if="{{checkResult.wrongCount === 0}}" class="perfect-tip">
      <image class="perfect-icon" src="/images/happy.png" mode="aspectFit"></image>
      <text class="perfect-text">å¤ªæ£’äº†ï¼å…¨éƒ¨æ­£ç¡®ï¼</text>
    </view>

    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
    <view class="bottom-actions">
      <button class="action-btn secondary" bindtap="reCheck">é‡æ–°æ£€æŸ¥</button>
      <button wx:if="{{checkResult.wrongCount > 0}}" class="action-btn primary" bindtap="saveToErrorBook">
        ä¿å­˜åˆ°é”™é¢˜æœ¬
      </button>
    </view>
  </view>
</view>
