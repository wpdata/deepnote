<view class="container">
  <!-- 顶部统计信息 -->
  <view class="stats-header">
    <view class="stat-item">
      <text class="stat-number">{{totalErrors}}</text>
      <text class="stat-label">错题总数</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{masteredErrors}}</text>
      <text class="stat-label">已掌握</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{unsolvedErrors}}</text>
      <text class="stat-label">待复习</text>
    </view>
  </view>

  <!-- 切换标签 -->
  <view class="tabs">
    <view
      class="tab {{currentTab === 'subject' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="subject"
    >
      <text>学科</text>
    </view>
    <view
      class="tab {{currentTab === 'knowledge' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="knowledge"
    >
      <text>知识点</text>
    </view>
  </view>

  <!-- 学科视图 -->
  <view class="content" wx:if="{{currentTab === 'subject'}}">
    <view class="subject-tabs">
      <scroll-view scroll-x class="subject-scroll">
        <view
          class="subject-tag {{currentSubject === item.id ? 'active' : ''}}"
          wx:for="{{subjects}}"
          wx:key="id"
          bindtap="selectSubject"
          data-id="{{item.id}}"
        >
          {{item.name}}
        </view>
      </scroll-view>
    </view>

    <view class="knowledge-list">
      <view
        class="knowledge-item"
        wx:for="{{knowledgeList}}"
        wx:key="id"
        bindtap="goToDetail"
        data-id="{{item.id}}"
      >
        <view class="knowledge-info">
          <text class="knowledge-name">{{item.name}}</text>
          <text class="error-count">{{item.errorCount}} 道错题</text>
        </view>
        <view class="progress-info">
          <view class="progress-bar-bg">
            <view class="progress-bar-fill" style="width: {{item.masteredRate}}%"></view>
          </view>
          <text class="progress-text">{{item.masteredRate}}%</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 知识点视图 -->
  <view class="content" wx:if="{{currentTab === 'knowledge'}}">
    <view class="knowledge-list">
      <view
        class="knowledge-item"
        wx:for="{{allKnowledgeList}}"
        wx:key="id"
        bindtap="goToDetail"
        data-id="{{item.id}}"
      >
        <view class="knowledge-info">
          <text class="subject-tag-small">{{item.subject}}</text>
          <text class="knowledge-name">{{item.name}}</text>
          <text class="error-count">{{item.errorCount}} 道错题</text>
        </view>
        <view class="progress-info">
          <view class="progress-bar-bg">
            <view class="progress-bar-fill" style="width: {{item.masteredRate}}%"></view>
          </view>
          <text class="progress-text">{{item.masteredRate}}%</text>
        </view>
      </view>
    </view>
  </view>
</view>
